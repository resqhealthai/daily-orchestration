<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>CVCH V9.5 - High Contrast</title>
    <script src="https://unpkg.com/@daily-co/daily-js"></script>
    <style>
        /* FORCE WHITE BACKGROUND, BLACK TEXT */
        body { 
            background-color: #FFFFFF !important; 
            color: #000000 !important; 
            font-family: monospace; 
            font-size: 18px; 
            margin: 20px;
            overflow: auto; /* Allow scrolling */
        }
        #log-container {
            border: 2px solid red;
            padding: 20px;
            background: #eee;
        }
        .error { color: red; font-weight: bold; }
        .success { color: green; font-weight: bold; }
        h1 { margin-top: 0; }
        video {
            position: fixed; bottom: 10px; right: 10px; width: 300px; height: 200px; 
            border: 5px solid blue; z-index: 100;
        }
    </style>
</head>
<body>

    <div id="log-container">
        <h1>V9.5 DIAGNOSTIC LOG</h1>
        <div id="console-output">Initializing...</div>
    </div>

    <script>
        const out = document.getElementById('console-output');
        
        // HELPER: Write to screen immediately
        function log(msg, type) {
            const div = document.createElement('div');
            div.innerText = `[${new Date().toLocaleTimeString()}] ${msg}`;
            if (type) div.className = type;
            out.appendChild(div);
        }

        // GLOBAL ERROR CATCHER
        window.onerror = function(message, source, lineno, colno, error) {
            log(`CRITICAL SYSTEM ERROR: ${message}`, 'error');
        };

        // STARTUP CHECK
        try {
            log("Script started.");

            // 1. Check Parameters
            const params = new URLSearchParams(window.location.search);
            const MODE = params.get('mode');
            const URL = params.get('url');
            log(`Mode detected: ${MODE || 'NONE'}`);
            log(`URL detected: ${URL ? 'YES' : 'NO'}`);

            if (!URL) throw new Error("Missing Room URL in parameters.");

            // 2. Check Daily Library
            if (!window.DailyIframe) {
                throw new Error("Daily.co Library failed to load. Check Internet Connection.");
            } else {
                log("Daily Library loaded successfully.", "success");
            }

            // 3. Init Call
            log("Creating Call Object...");
            const call = window.DailyIframe.createCallObject({
                dailyConfig: { experimentalChromeVideoMuteLightOff: true }
            });

            // 4. Setup Events
            call.on('joined-meeting', () => log("Successfully Joined Meeting!", "success"));
            call.on('error', (e) => log(`DailyAPI Error: ${e.errorMsg}`, "error"));
            call.on('left-meeting', () => log("Left meeting."));
            
            call.on('track-started', (e) => {
                if (e.participant.local) return;
                log(`Video Track Received from: ${e.participant.user_name}`, "success");
                
                //
