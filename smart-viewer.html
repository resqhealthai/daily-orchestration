<!DOCTYPE html>
<html>
<head>
    <title>ResQ Smart Viewer</title>
    <meta charset="utf-8">
    <script crossorigin src="https://api.daily.co/daily.js"></script>
    <style>body { margin: 0; background: #000; overflow: hidden; }</style>
</head>
<body>
    <script>
        async function init() {
            const params = new URLSearchParams(window.location.search);
            const roomUrl = params.get('roomUrl');
            const mode = params.get('mode') || 'face';

            // 1. DEFINE CUSTOM CSS FOR EACH MODE
            // Note: These selectors target Daily's internal elements
            
            let customCSS = '';
            
            if (mode === 'face') {
                // FACE MODE: Hide Screen Shares, Show Video
                // We target the screen share container and hide it
                customCSS = `
                    .daily-video-div.daily-screen-share { display: none !important; }
                    .daily-video-element.daily-screen-share { display: none !important; }
                `;
            } else if (mode === 'screen') {
                // SCREEN MODE: Prioritize Screen Share
                // If there is no screen share, this might show black or active speaker
                // We try to hide normal video tiles if a screen share exists
                // (This is trickier, but usually Active Speaker layout handles it well)
                // For now, let's leave it as default Active Speaker which prefers screens
            }

            // 2. CREATE FRAME
            const callFrame = window.DailyIframe.createFrame(document.body, {
                showLeaveButton: false,
                showFullscreenButton: false,
                iframeStyle: { width: '100%', height: '100%', border: '0' },
                // Inject the CSS
                cssText: customCSS
            });

            // 3. JOIN
            await callFrame.join({ 
                url: roomUrl,
                showLocalVideo: false,
                startVideoOff: true,
                startAudioOff: false,
                userName: `Display-${mode}`
            });
        }

        window.addEventListener('load', () => setTimeout(init, 500));
    </script>
</body>
</html>
