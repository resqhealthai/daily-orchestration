<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>CVCH Orchestrator V6.1 - Dynamic Titles</title>
    <script src="https://unpkg.com/@daily-co/daily-js"></script>
    <style>
        /* --- 1. VISUALS & GRAPHIC --- */
        body { 
            margin: 0; padding: 0; 
            overflow: hidden; 
            height: 100vh; 
            background-color: #000;
            display: flex; 
            justify-content: center; 
            align-items: center;

            /* The Standby Graphic (Visible when no video is playing) */
            background-image: url('https://placehold.co/1920x1080/222222/FFFFFF?text=ResQ+Health+Training+Center'); 
            background-size: cover; 
            background-position: center; 
            background-repeat: no-repeat;
        }

        /* --- 2. VIDEO LAYOUT --- */
        /* Z-Index 10 ensures video covers the graphic when active */
        video { 
            width: 100%; height: 100%; 
            object-fit: contain; 
            position: absolute; 
            z-index: 10; 
            background: #000; 
        }

        /* --- 3. UI LAYER (Errors/Status) --- */
        #ui-layer {
            z-index: 20;
            position: relative;
            text-align: center;
            color: white;
            background: rgba(0,0,0,0.8);
            padding: 20px;
            border-radius: 8px;
            display: none;
            font-family: sans-serif;
        }
    </style>
</head>
<body>
    <div id="call-container"></div>
    
    <div id="ui-layer">
        <h2 id="status-text">Initializing...</h2>
    </div>

    <script>
        const params = new URLSearchParams(window.location.search);
        const ROOM_URL = params.get('url'); 
        const MODE = params.get('mode'); // 'face', 'screen', or 'tablet'
        
        // --- DYNAMIC TITLE LOGIC (NEW V6.1) ---
        // This fixes the race condition where the default title overwrites the AppleScript's name.
        // If a custom title is passed in the URL (e.g. &title=Instructor%20Face), apply it immediately.
        const CUSTOM_TITLE = params.get('title');
        if (CUSTOM_TITLE) {
            document.title = CUSTOM_TITLE;
        }

        // Allow overriding the target device name via URL (default to OBS)
        // usage: &camera=OBS%20Virtual%20Camera
        const TABLET_CAM_NAME = params.get('camera') || 'OBS'; 

        // --- 1. CONFIGURE THE CALL OBJECT
