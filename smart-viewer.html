<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Smart Viewer v12.0</title>
    <style>
        body { 
            background: #000; margin: 0; height: 100vh; 
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            font-family: sans-serif; color: white;
        }
        .icon { font-size: 80px; display: block; margin-bottom: 20px; }
        .text { font-size: 24px; letter-spacing: 2px; text-transform: uppercase; font-weight: bold; }
        .subtext { font-size: 16px; color: #aaa; margin-top: 15px; }
        
        /* MODE COLORS */
        body.mode-face .text   { color: #7FDBFF; }
        body.mode-screen .text { color: #2ECC40; }
        body.mode-tablet .text { color: #FF4136; }
    </style>
</head>
<body>

    <div id="content">
        <div class="icon">ðŸš€</div>
        <div id="status" class="text">INITIALIZING...</div>
        <div id="sub" class="subtext">Smart Viewer v12.0</div>
    </div>

    <script>
        // 1. GET PARAMS
        var params = new URLSearchParams(window.location.search);
        var MODE = params.get('mode');
        var RAW_URL = params.get('url');
        
        // Clean URL
        var URL = RAW_URL ? RAW_URL.trim().replace(/"/g, '') : "";

        // 2. SET UI
        var statusEl = document.getElementById('status');
        var subEl = document.getElementById('sub');
        
        if (MODE) document.body.classList.add('mode-' + MODE);

        if (MODE === 'face') {
            statusEl.innerText = "CONNECTING TO INSTRUCTOR...";
        } else if (MODE === 'screen') {
            statusEl.innerText = "CONNECTING TO SCREEN SHARE...";
        } else if (MODE === 'tablet') {
            statusEl.innerText = "PREPARING TABLET UPLINK...";
        }

        // 3. EXECUTE HANDOFF
        function performHandoff() {
            if (!URL) {
                statusEl.innerText = "CONFIG ERROR";
                subEl.innerText = "No URL provided.";
                return;
            }

            statusEl.innerText = "JOINING ROOM...";
            subEl.innerText = "Redirecting to secure video feed...";
            
            // THE FIX: Direct Browser Redirect (Matches your Manual Test)
            window.location.replace(URL);
        }

        // 4. TIMING LOGIC
        if (MODE === 'tablet') {
            // Tablet waits 8 seconds to prevent camera resource fighting
            var countdown = 8;
            var timer = setInterval(function() {
                subEl.innerText = "Launching in " + countdown + "s...";
                countdown--;
                if (countdown < 0) {
                    clearInterval(timer);
                    performHandoff();
                }
            }, 1000);
        } else {
            // Monitors launch instantly
            performHandoff();
        }
    </script>
</body>
</html>
